var bb={log:function(e,t,a){a="undefined"!=typeof a?a:"#e02437";var s="",o=new Date;s+=o.getFullYear()+"-"+("0"+(o.getMonth()+1)).slice(-2)+"-"+("0"+o.getMonth()).slice(-2),s+=" "+("0"+o.getHours()).slice(-2)+":"+("0"+o.getMinutes()).slice(-2)+":"+("0"+o.getSeconds()).slice(-2),console.log("["+s+"]%c "+e,"color: "+a,t)}},hello="/screens/welcome/",goodbye="/screens/goodbye/",quiz="/screens/quiz/",quiza="/screens/quiz/answers.html",ponydrome="https://www.youtube.com/embed/videoseries?list=PL5oyPmRlu5uqI2fyqxDfnGuYmWSJqDCbS";bb.stream={init:function(){bb.stream.url(hello)},url:function(e){$(".js-streamer").attr("src",e),bb.log("Streamer","Changed frame to "+e)},toggle:function(){$(".stream").toggleClass("stream--collapse")}},bb.tweetstream={loadedTweets:[],init:function(){bb.tweetstream.update(),setInterval(bb.tweetstream.update,3e4)},update:function(){var e=$("#tmpl-tweet").html();bb.log("Tweetstream","Checking for updates..."),Mustache.parse(e),$.ajax({dataType:"json",cache:!1,url:"/service/tweets.php"}).done(function(t){var a=$(".js-tweetstream"),s="";$.each(t.tweets,function(t,a){return $.inArray(a.id,bb.tweetstream.loadedTweets)<=-1?(bb.tweetstream.loadedTweets.push(a.id),s+=Mustache.render(e,a),bb.log("Tweetstream","Tweets inserted!"),void 0):(bb.log("Tweetstream","No more tweets to speak of."),!1)}),a.prepend($(s).hide().fadeIn()),a.children().each(function(e,t){var a=$(t);e>9?a.fadeOut(500,function(){a.remove()}):a.find("[data-timeago]").timeago()})}).fail(function(){bb.log("Tweetstream","Loading failed.")})}},bb.schedule={lastTimestamp:0,init:function(){bb.schedule.update(),setInterval(bb.schedule.update,62e3)},update:function(){var e=$("#tmpl-schedule").html(),t=Math.round((new Date).getTime()/1e3);bb.log("Schedule","Checking for updates..."),Mustache.parse(e),$.ajax({dataType:"json",cache:!1,url:"/service/schedule.json"}).done(function(a){$.each(a.schedule,function(a,s){if(s.timestamp>t){if(s.timestamp!=bb.schedule.lastTimestamp){bb.schedule.lastTimestamp=s.timestamp;var o=Mustache.render(e,s);return $(".js-schedule-placeholder").fadeOut(function(){$(this).html(o).fadeIn()}),bb.log("Schedule","Event updated!"),!1}return bb.log("Schedule","Event doesn't need updating."),!1}})}).fail(function(){bb.log("Schedule","Loading failed.")})}},$(document).ready(function(){bb.schedule.init(),bb.tweetstream.init(),bb.stream.init()});var help=function(){bb.log("bb.stream.url(url)","Navigate to a custom stream URL or enter a keyword.","#0000cc"),bb.log("	hello","Welcome message.","#0000cc"),bb.log("	goodbye","Goodbye message.","#0000cc"),bb.log("	quiz","Quiz question slides.","#0000cc"),bb.log("	quiza","Quiz answer slides.","#0000cc"),bb.log("	ponydrome","Ponydrome playlist (YouTube).","#0000cc"),bb.log("bb.stream.toggle()","Expand/collapse streamer (shows more tweets).","#0000cc"),bb.log("bb.tweetstream.update()","Force update tweetstream.","#0000cc"),bb.log("bb.schedule.update()","Force update schedule.","#0000cc")};