var bb={},hello="/screens/hello/",goodbye="/screens/goodbye/",ponydrome="https://www.youtube.com/embed/videoseries?list=PL5oyPmRlu5uqI2fyqxDfnGuYmWSJqDCbS&autoplay=1";bb.stream={init:function(){bb.stream.url(hello)},url:function(e){$("[data-stream-iframe]").attr("src",e)},toggle:function(){$("[data-stream]").toggleClass("stream--collapse")}},bb.tweetstream={init:function(){},update:function(e){var t=$("[data-tweets-list]"),a=$("#tmpl-tweet").html();Mustache.parse(a);var n=Mustache.render(a,e);t.prepend($(n).hide().fadeIn()),t.children().each(function(e,t){var a=$(t);a.find("[data-timeago]").timeago(),e>15&&a.fadeOut(500,function(){a.remove()})})},updateMultiple:function(e){$.each(e,function(e,t){bb.tweetstream.update(t)})}},bb.schedule={lastTimestamp:0,init:function(){bb.schedule.update(),setInterval(bb.schedule.update,6e4)},toggle:function(){$("[data-schedule]").slideToggle()},update:function(){var e=$("#tmpl-schedule").html(),t=Math.round((new Date).getTime()/1e3);Mustache.parse(e),$.ajax({dataType:"json",cache:!1,url:"/service/schedule.json"}).done(function(a){var n=!1;if($.each(a.schedule,function(a,i){var u=new Date(i.timestamp).getTime();if(u>t){if(n=!0,u!=bb.schedule.lastTimestamp){bb.schedule.lastTimestamp=u,i.humanTime=new Date(u).toISOString();var s=Mustache.render(e,i);return $("[data-schedule-content]").fadeOut(function(){$(this).html(s).fadeIn(),jQuery.timeago.settings.allowFuture=!0,$(this).find("[data-timeago]").timeago()}),!1}return!1}}),0==n){var i=Mustache.render(e,{timestamp:"",event:"Nothing :("});$("[data-schedule-content]").fadeOut(function(){$(this).html(i).fadeIn()})}}).fail(function(e,t,a){console.log(e,t,a)})}},$(document).ready(function(){bb.stream.init(),bb.tweetstream.init(),bb.schedule.init()});