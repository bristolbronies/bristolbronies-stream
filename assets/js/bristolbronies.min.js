var bb={log:function(e,t){var a="",c=new Date;a+=c.getFullYear()+"-"+("0"+(c.getMonth()+1)).slice(-2)+"-"+("0"+c.getMonth()).slice(-2),a+=" "+("0"+c.getHours()).slice(-2)+":"+("0"+c.getMinutes()).slice(-2)+":"+("0"+c.getSeconds()).slice(-2),console.log("["+a+"]%c "+e,"color: #e02437",t)}};bb.tweetstream={init:function(){bb.tweetstream.checkForUpdate(),setInterval(bb.tweetstream.checkForUpdate,1e4)},checkForUpdate:function(){var e=$("#tmpl-tweet").html();bb.log("Tweetstream","Checking for updates..."),Mustache.parse(e);var t={user:"bristolbronies",avatar:"http://placeponi.es/50/50",time:"2015-04-04T11:00:00",content:"Some words go here! Ha ha! "+Math.random()},a=Mustache.render(e,t);$(".js-tweetstream").prepend(a),bb.log("Tweetstream","New tweets added!")}},bb.schedule={lastTimestamp:0,init:function(){bb.schedule.checkForUpdate(),setInterval(bb.schedule.checkForUpdate,3e4)},checkForUpdate:function(){var e=$("#tmpl-schedule").html(),t=Math.round((new Date).getTime()/1e3);bb.log("Schedule","Checking for updates..."),Mustache.parse(e),$.ajax({dataType:"json",cache:!1,url:"/config/schedule.json"}).done(function(a){$.each(a.schedule,function(a,c){if(c.timestamp>t){if(c.timestamp!=bb.schedule.lastTimestamp){bb.schedule.lastTimestamp=c.timestamp;var n=Mustache.render(e,c);return $(".js-schedule-placeholder").fadeOut(function(){$(this).html(n).fadeIn()}),bb.log("Schedule","Event updated!"),!1}return bb.log("Schedule","Event doesn't need updating."),!1}})}).fail(function(){console.log("FAILURE")})}},$(document).ready(function(){bb.schedule.init(),bb.tweetstream.init()});