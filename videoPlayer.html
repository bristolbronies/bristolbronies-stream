<!DOCTYPE html>
<html>
  <body>
    <div id="player"></div>
    <script src="adminKey"></script>
    <script src="https://cdn.socket.io/socket.io-1.3.5.js"></script>
    <script src="https://cdn.socket.io/socket.io-1.3.5.js"></script>
    <script>
      var socket = io();
      socket.on("command",function(cmd,params){
        if (cmd == "playsong"){
          player.loadVideoById(params.id,0,"large");
          console.log("Plaing",params);
          io.emit("command","videoplaying",{key:ADMIN_KEY});
        }
      })

      var player;
      function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
          height: '390',
          width: '640',
          events: {
            'onReady': getNextVideo,
            'onStateChange': onPlayerStateChange
          }
        });
      }

      // When finished request a new song
      function onPlayerStateChange(event) {
        if (event.data == YT.PlayerState.ENDED) {
          getNextVideo();
        }
      }

      function getNextVideo(){
        socket.emit("command","nextsong",{key:ADMIN_KEY})
      }

    </script>
    <script src="https://www.youtube.com/iframe_api"></script>
  </body>
</html>
